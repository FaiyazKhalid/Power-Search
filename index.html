<!DOCTYPE html>
<html ng-app='wikiModul' lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Angular Wiki Search</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="bower_components/bootstrap-css-only/css/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
    <script async src="dist.js"></script>
</head>

<body ng-controller='MainController as mainControl' ng-init='mainControl.init()'>

    <header class="header">
        <!-- params -->
        <section ng-controller="ParamsController as paramsControl" class="container">
            <div class="logo-wrap row">
                <div class="col-md-6">
                    <h1><a href="index.html" ng-click="paramsControl.resetAndReload()">Wikipedia power search</a></h1>
                </div>
                <form class="col-md-6" role="form" ng-cloak>
                    <div class="wiki-logos">
                        <!-- projects -->
                        <label ng-repeat="project in paramsControl.projects">
                            <img ng-src="{{project.logo}}" alt="{{project.name}}" title="{{project.name}}" ng-class="{ 'selected-logo': paramsControl.isSelectedProject(project) }">
                            <input type="radio" ng-model="paramsControl.params.settings.domain" value="{{project.name}}" ng-click="paramsControl.refreshLanguages(); mainControl.search()">
                        </label>
                        <span class="justify-helper"></span>
                    </div>
                </form>
            </div>

            <form class="search-form row" role="form" ng-cloak>
                <div class="col-md-6">
                    <div class="search-wrapper form-group">
                        <button class="btn btn-success search-button input-lg" type="submit" ng-click='mainControl.search()'>
                            <span class="glyphicon glyphicon-search"></span>
                        </button>
                        <!-- search field -->
                        <input ng-model='paramsControl.params.settings.searchTerm' ng-change='mainControl.search()' class="form-control input-lg" autofocus>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group text-center">
                        <!-- filters -->
                        <label ng-repeat="filter in paramsControl.params.searchFilters" class="radio-inline">
                            <input type="radio" ng-model="paramsControl.params.settings.searchFilter" value="{{filter}}" ng-change="mainControl.search()"> {{filter || 'content'}}
                        </label>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group">
                        <!-- languages -->
                        <select ng-model="paramsControl.params.settings.lang" ng-options="item.prefix as item.language for item in paramsControl.languages.all | orderBy:'prefix' " ng-change='mainControl.search()' class="form-control input-sm" ng-disabled="paramsControl.isCommons()"></select>
                    </div>
                    <label class="checkbox-inline">
                        <!-- remember -->
                        <input type="checkbox" ng-model="paramsControl.params.settings.remember" ng-change="paramsControl.toggleSave()">
                        <small>remember settings</small>
                    </label>
                </div>
                <div class="col-md-1">
                    <div class="form-group">
                        <!-- maxResults -->
                        <input type="number" min="1" max="50" ng-model='paramsControl.params.basicSearch.gsrlimit' ng-change='paramsControl.checkMaxResults(); mainControl.search()' class="form-control input-sm">
                    </div>
                    <label class="checkbox-inline">
                        <!-- alphabetical -->
                        <input type="checkbox" ng-model="paramsControl.params.settings.orderBy" ng-true-value="'title'" ng-false-value="''">
                        <small>alphabetical</small>
                    </label>
                </div>
            </form>
        </section>
    </header>


    <main class="container main" ng-cloak>

        <!-- TODO: ovo je izvan opsega! -->
        <p ng-show="pageControl.languages.error" class="text-danger">{{pageControl.languages.error}}</p>

        <div class="row">
            <!-- page -->
            <div ng-controller="PageController as pageControl" ng-class="pageControl.pageLarge ? 'col-md-12' : 'col-md-6 col-md-push-6'">
                <nav ng-show="pageControl.pageLarge">
                    <button title="Back to serch results" class="btn btn-link" ng-click="pageControl.toggleLeadLarge()">« Back</button>

                    <button title="Search for this term" class="btn btn-link pull-right" ng-click="pageControl.searchForThisTerm(pageControl.page.result.title)">Search for this term »</button>
                </nav>
                <section class='lead-wrapper' ng-show='pageControl.page.result'>
                    <article class="choosen-article clearfix">
                        <h1 class="text-info">
                            <span title="Englarge this article" ng-click="pageControl.toggleLeadLarge()" class="pointer">{{pageControl.page.result.title}}</span>
                        </h1>
                        <a ng-href="{{pageControl.page.result.image}}" ng-show="pageControl.page.result.image" target="_blank">
                            <img ng-src="{{pageControl.page.result.thumbnail.source}}" alt="{{pageControl.page.result.title}}" class="img-large img-thumbnail pull-right">
                        </a>
                        <section ng-bind-html='pageControl.page.result.extract' ng-dblclick="mainControl.selectText()"></section>
                    </article>

                    <p class="read-more text-info pull-right"><a ng-href="{{pageControl.page.result.fullurl}}" target="_blank">See on <span class="text-capitalize">{{pageControl.params.settings.domain}}</span> >> </a></p>
                </section>
            </div>

            <!-- pages-->
            <div ng-controller="PagesController as pagesControl" ng-class="pageControl.pageLarge ? 'hidden' : 'col-md-6 col-md-pull-6'">

                <p ng-show="pagesControl.pages.error" class="text-danger">{{pagesControl.pages.error}}</p>
                <p ng-hide="pagesControl.pages.results.length" class="text-info">{{pagesControl.pages.noResults}}</p>

                <article ng-repeat="page in pagesControl.pages.results | orderBy: pagesControl.params.settings.orderBy" class="articles clearfix" ng-class="{'hidden': pagesControl.isSelectedPage(page)}">
                    <h2 class="text-info">
                        <span title="Open this article" ng-click="mainControl.open(page.title)" class="pointer" >{{page.title}}</span>
                    </h2>
                    <a ng-href="{{page.image}}" target="_blank">
                        <img ng-src="{{page.thumbnail.source}}" alt="{{page.title}}" class="img-thumbnail" ng-show="page.thumbnail.source">
                    </a>
                    <section ng-bind-html='page.extract' ng-dblclick="mainControl.selectText()"></section>
                    <p class="read-more text-info pull-right"><a ng-href="{{page.fullurl}}" target="_blank">See on <span class="text-capitalize">{{pagesControl.params.settings.domain}}</span> >> </a></p>
                </article>
            </div>

            <imagepage></imagepage>

            <images></images>

        </div>
    </main>

    <div class="github-fork-ribbon-wrapper right-bottom">
        <div class="github-fork-ribbon">
            <a href="https://github.com/mudroljub/angular-main-search">Fork me on GitHub</a>
        </div>
    </div>

</body>

</html>
