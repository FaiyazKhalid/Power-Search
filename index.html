<!DOCTYPE html>
<html ng-app='wikiModul' lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Angular Wiki Search</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="bower_components/bootstrap-css-only/css/bootstrap.min.css">
    <link rel="stylesheet" href="bower_components/github-fork-ribbon-css/index.css" />
    <link rel="stylesheet" href="style.css">

    <script src='bower_components/angular/angular.min.js'></script>
    <script src='bower_components/angular-sanitize/angular-sanitize.min.js'></script>
    <script src="bower_components/blueimp-md5/js/md5.min.js"></script>

    <script src='app.js'></script>
    <script src='directives/autofocus.js'></script>
    <script src='services/utils.js'></script>
    <script src='services/StaticData.js'></script>
    <script src='services/Params.js'></script>
    <script src='services/Api.js'></script>
</head>

<body ng-controller='WikiController as wiki' ng-init='wiki.init()'>

    <header class="header">
        <section class="container">

            <!-- wiki projects -->
            <div class="logo-wrap row">
                <div class="col-md-6">
                    <h1>Wikipedia power search</h1>
                </div>
                <div class="col-md-6">
                    <div class="wiki-logos">
                        <span ng-repeat="project in wiki.projects" >
                            <img ng-src="{{project.logo}}" alt="{{project.name}}" ng-click="wiki.setDomain(project.name); wiki.search();" title="{{project.name}}" ng-class="{ 'selected-logo': project.name == wiki.domain }">
                        </span>
                        <span class="justify-helper"></span>
                    </div>
                </div>
            </div>

            <!-- search criteria -->
            <form class="search-form row" role="form">
                <div class="col-md-6">
                    <div class="search-wrapper form-group">
                        <button class="btn btn-success search-button input-lg" type="submit" ng-click='wiki.search()'>
                            <span class="glyphicon glyphicon-search"></span>
                        </button>
                        <!-- search field -->
                        <input ng-model='wiki.searchTerm' ng-change='wiki.search()' class="form-control input-lg" autofocus>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group text-center">
                        <!-- TODO: create ng repeat -->
                        <label class="radio-inline">
                            <input type="radio" ng-model="wiki.searchFilter" value="intitle:" ng-change='wiki.setFilter(); wiki.search()'> in title
                        </label>
                        <label class="radio-inline">
                            <input type="radio" ng-model="wiki.searchFilter" value="" ng-change='wiki.setFilter(); wiki.search()'> content
                        </label>
                        <label class="radio-inline">
                            <input type="radio" ng-model="wiki.searchFilter" value="prefix:" ng-change='wiki.setFilter(); wiki.search()'> prefix
                        </label>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group">
                        <select ng-model="wiki.lang" ng-change='wiki.search()' class="form-control">
                            <option ng-repeat="lang in wiki.languages" value="{{lang.id}}">{{lang.name}}</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-1">
                    <div class="form-group">
                        <input type="number" min="1" max="50" ng-model='wiki.maxResults' ng-change='wiki.checkMaxResults(); wiki.search()' class="form-control">
                    </div>
                </div>
            </form>

        </section>
    </header>

    <main class="container main" ng-cloak>

        <p>{{wiki.api.error}}</p>

        <div class="row">

            <!-- lead article -->
            <div ng-class="wiki.leadLarge ? 'col-md-12' : 'col-md-6 col-md-push-6'">
                <button title="Back to serch results" class="btn btn-link" ng-show="wiki.leadLarge" ng-click="wiki.toggleLeadLarge()">« Back</button>

                <button title="Back to serch results" class="btn btn-link" ng-show="wiki.leadLarge" ng-click="wiki.searchForLeadTerm(wiki.api.page.title)">Search for this term »</button>

                <section class='choosen-article-wrapper' ng-show='wiki.api.page'>
                    <article class="choosen-article clearfix">
                        <h1 class="text-info">
                            <span class="pointer" title="Englarge this article" ng-click="wiki.toggleLeadLarge()">{{wiki.api.page.title}}</span>
                        </h1>
                        <a ng-href="{{wiki.api.page.imageUrl}}" target="_blank">
                            <img ng-src="{{wiki.leadLarge && wiki.api.page.imageUrl || wiki.api.page.imageThumbUrl}}" alt="{{wiki.api.page.title}}" class="img-large img-thumbnail pull-right" ng-show="wiki.api.page.imageUrl">
                        </a>
                        <section ng-bind-html='wiki.api.page.extract' ng-dblclick="wiki.selectText()"></section>
                    </article>

                    <p class="read-more text-info pull-right"><a ng-href="{{wiki.api.page.fullurl}}" target="_blank">See on <span class="text-capitalize">{{wiki.domain}}</span> >> </a></p>
                </section>
            </div>

            <!-- search results-->
            <div ng-class="wiki.leadLarge ? 'hidden' : 'col-md-6 col-md-pull-6'">
                <article ng-repeat="page in wiki.api.results | orderBy:'title' " class="articles clearfix">
                    <h2 class="text-info">
                        <span class="pointer" title="Open this article" ng-click="wiki.open(page.title)">{{page.title}}</span>
                    </h2>
                    <img ng-src="{{page.thumbnail.source}}" alt="{{page.title}}" class="img-thumbnail" ng-show="page.thumbnail.source">
                    <section ng-bind-html='page.extract' ng-dblclick="wiki.selectText()"></section>
                    <p class="read-more text-info pull-right"><a ng-href="{{page.fullurl}}" target="_blank">See on <span class="text-capitalize">{{wiki.domain}}</span> >> </a></p>
                </article>
            </div>

        </div>

    </main>

    <div class="github-fork-ribbon-wrapper right-bottom">
        <div class="github-fork-ribbon">
            <a href="https://github.com/mudroljub/angular-wiki-search">Fork me on GitHub</a>
        </div>
    </div>

</body>

</html>
